(()=>{"use strict";var e={d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};function t(e){e.classList.add("popup_is-opened")}function r(e){e.classList.remove("popup_is-opened")}function n(e){e.querySelector(".popup__close").addEventListener("click",(function(){return r(e)})),document.addEventListener("click",(function(t){t.target.classList.contains("popup_is-opened")&&r(e)})),document.addEventListener("keydown",(function(t){"Escape"===t.key&&r(e)}))}e.d({},{d:()=>y}),document.querySelectorAll(".popup").forEach((function(e){e.classList.add("popup_is-animated")}));var o=document.querySelector(".popup_type_image"),c=o.querySelector(".popup__image"),a=o.querySelector(".popup__caption");n(o);var i=document.querySelector("#card-template").content;function u(e,t,r,n,o,c){var a=i.querySelector(".places__item").cloneNode(!0);return a.querySelector(".card__image").src=t,a.querySelector(".card__image").alt=e,a.querySelector(".card__title").textContent=e,a.querySelector(".card__likes").textContent=r,a.querySelector(".card__id").textContent=o,1!=n&&a.querySelector(".card__delete-button").classList.add("card__delete-button_inactive"),c&&a.querySelector(".card__like-button").classList.add("card__like-button_is-active"),a}var p=document.querySelector(".popup_type_new-card"),d=document.querySelector(".profile__add-button"),l=p.querySelector(".popup__form");d.addEventListener("click",(function(){t(p)})),l.addEventListener("submit",(function(e){e.preventDefault();var t,n,o=document.querySelector(".popup__input_type_card-name").value,c=document.querySelector(".popup__input_type_url").value;(t=o,n=c,fetch("https://nomoreparties.co/v1/apf-cohort-202/cards",{method:"POST",headers:{authorization:"1de85579-7d0e-4533-a5e4-59dce429e385","Content-Type":"application/json"},body:JSON.stringify({name:t,link:n})}).then((function(e){return e.json()})).then((function(e){return e._id}))).then((function(e){y.prepend(u(o,c,0,!0,e,!1))})),r(p)})),n(p);var s=null,_=document.querySelector(".popup_type_edit"),m=document.querySelector(".profile__edit-button");_.querySelector(".popup__form").addEventListener("submit",(function(e){e.preventDefault();var t,n,o=document.querySelector(".popup__input_type_name").value,c=document.querySelector(".popup__input_type_description").value,a=document.querySelector(".profile__title"),i=document.querySelector(".profile__description");a.textContent=o,i.textContent=c,r(_),t=o,n=c,fetch("https://nomoreparties.co/v1/apf-cohort-202/users/me",{method:"PATCH",headers:{authorization:"1de85579-7d0e-4533-a5e4-59dce429e385","Content-Type":"application/json"},body:JSON.stringify({name:t,about:n})})})),n(_);var y=document.querySelector(".places__list");y.addEventListener("click",(function(e){var r,n,i;e.target.classList.contains("card__like-button")&&(e.target.classList.contains("card__like-button_is-active")?(e.target.classList.remove("card__like-button_is-active"),r=e.target.parentElement.parentElement.querySelector(".card__id").textContent,fetch("https://nomoreparties.co/v1/apf-cohort-202/cards/likes/"+r,{method:"DELETE",headers:{authorization:"1de85579-7d0e-4533-a5e4-59dce429e385"}}),e.target.parentElement.querySelector(".card__likes").textContent=Number(e.target.parentElement.querySelector(".card__likes").textContent)-1):(e.target.classList.add("card__like-button_is-active"),function(e){fetch("https://nomoreparties.co/v1/apf-cohort-202/cards/likes/"+e,{method:"PUT",headers:{authorization:"1de85579-7d0e-4533-a5e4-59dce429e385"}})}(e.target.parentElement.parentElement.querySelector(".card__id").textContent),e.target.parentElement.querySelector(".card__likes").textContent=Number(e.target.parentElement.querySelector(".card__likes").textContent)+1)),e.target.classList.contains("card__delete-button")&&(e.target.closest(".places__item").remove(),function(e){fetch("https://nomoreparties.co/v1/apf-cohort-202/cards/"+e,{method:"DELETE",headers:{authorization:"1de85579-7d0e-4533-a5e4-59dce429e385"}})}(e.target.parentElement.querySelector(".card__id").textContent)),e.target.classList.contains("card__image")&&(n=e.target.alt,i=e.target.src,c.src=i,c.alt=n,a.textContent=n,t(o))})),m.addEventListener("click",(function(){var e=document.querySelector(".profile__title").textContent,r=document.querySelector(".profile__description").textContent;document.querySelector(".popup__input_type_name").value=e,document.querySelector(".popup__input_type_description").value=r,t(_)})),Array.from(document.querySelectorAll(".popup__form")).forEach((function(e){!function(e){var t=Array.from(e.querySelectorAll(".popup__input")),r=e.querySelector(".popup__button");t.forEach((function(n){n.addEventListener("input",(function(){!function(e,t){t.validity.valid?function(e,t){var r=e.querySelector(".".concat(t.id,"-error"));t.classList.remove("popup__input_type_error"),r.classList.remove("popup__input-error_active"),r.textContent=""}(e,t):function(e,t,r){var n=e.querySelector(".".concat(t.id,"-error"));t.classList.add("popup__input_type_error"),n.textContent=r,n.classList.add("popup__input-error_active")}(e,t,t.validationMessage)}(e,n),function(e,t){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?t.classList.remove("popup__button_inactive"):t.classList.add("popup__button_inactive")}(t,r)}))}))}(e)})),fetch("https://nomoreparties.co/v1/apf-cohort-202/users/me",{headers:{authorization:"1de85579-7d0e-4533-a5e4-59dce429e385"}}).then((function(e){return e.json()})).then((function(e){document.querySelector(".profile__image").style.backgroundImage=e.avatar,document.querySelector(".profile__title").textContent=e.name,document.querySelector(".profile__description").textContent=e.about,s=e._id})),fetch("https://nomoreparties.co/v1/apf-cohort-202/cards",{headers:{authorization:"1de85579-7d0e-4533-a5e4-59dce429e385"}}).then((function(e){return e.json()})).then((function(e){for(var t=0;t<e.length;t++)e[t].owner._id!==s?e[t].likes.some((function(e){return e._id===s}))?y.append(u(e[t].name,e[t].link,e[t].likes.length,!1,e[t]._id,!0)):y.append(u(e[t].name,e[t].link,e[t].likes.length,!1,e[t]._id,!1)):e[t].likes.some((function(e){return e._id===s}))?y.append(u(e[t].name,e[t].link,e[t].likes.length,!0,e[t]._id,!0)):y.append(u(e[t].name,e[t].link,e[t].likes.length,!0,e[t]._id,!1))}))})();